#!/bin/bash

# Define variables for container, user, and database names
container_name="{{ database_container_name }}"
database_user="{{ database_user }}"
database_name="{{ database_name }}"

# Create the database user if it doesn't exist
docker exec "$container_name" psql -U postgres -tc "SELECT 1 FROM pg_user WHERE usename = '$database_user'" | grep -q 1 || docker exec "$container_name" psql -U postgres -c "CREATE USER $database_user"

# Check if the database exists and create it if it doesn't
docker exec "$container_name" psql -U "$database_user" postgres -tc "SELECT 1 FROM pg_database WHERE datname = '$database_name'" | grep -q 1 || docker exec "$container_name" psql -U "$database_user" postgres -c "CREATE DATABASE $database_name"

